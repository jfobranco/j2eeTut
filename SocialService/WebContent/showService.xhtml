<ui:composition template="/template.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

	<f:metadata>
		<f:viewParam name="serviceId" value="#{showService.serviceId}" />
	</f:metadata>

	<ui:define name="content">
		<c:if test="#{showService.service.profile.headerPic != null}">
			<div id="#headerPic">
				<img src="images/#{showService.service.profile.headerPic}" width="600" height="200"/>
			</div>
		</c:if>
		<c:if test="#{showService.service.profile.headerPic == null}">
			<div class=".placeholder" style="width: 600px; height: 200px; background: #fff;"></div>
		</c:if>
		<h1>#{showService.service.name}</h1>
		#{showService.service.address}<br />
		#{showService.service.mail}<br />
		#{showService.service.phone}<br />
		#{showService.service.owner.firstName}<br />
		<br />
		<h:form>
			<c:set var="follow" value="#{sessionScope.user != null and sessionScope.user.services.contains(showService.service) ? 'Unfollow' : 'Follow'}" scope="request" />
			<c:if test="#{sessionScope.user != null}">
				<h:commandButton value="#{follow}" action="#{showService.followService}" styleClass="button"/>
			</c:if>
			<c:if test="#{sessionScope.user != null and showService.service.owner.id == sessionScope.user.id}">
				<h:link value="Add post" outcome="createPost.xhtml" styleClass="button">
					<f:param value="#{showService.service.id}" name="serviceId"/>
				</h:link>
				<h:link value="Add page" outcome="createPage.xhtml" styleClass="button">
					<f:param value="#{showService.service.id}" name="serviceId"/>
				</h:link>
			</c:if>
		</h:form>
		<h:messages globalOnly="true" infoClass="info" />
		<br />
		<br />
		<h1>Pages</h1>
		<div id="#center">
			<c:if test="#{empty showService.service.pages}">
				<p class="info">No pages</p>
			</c:if>
			<c:if test="#{!empty showService.service.pages}">
				<table class="center">
					<tr><th>Title</th></tr>
					<c:forEach items="#{showService.service.pages}" var="item">
						<tr><td>#{item.title}</td>
							<td>
								<h:link outcome="showPage.xhtml">
									<f:param value="#{item.id}" name="serviceId" />
									Go To
								</h:link>
							</td>
						</tr>
					</c:forEach>
				</table>
			</c:if>
		</div>
		<ui:include src="posts.xhtml">
			<ui:param name="posts" value="#{showService.service.posts}" />
		</ui:include>
	</ui:define>
</ui:composition>